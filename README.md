<h1>Static Malware Analysis</h1>

<h2>Description</h2>
This project involves performing some static malware analysis on some known malware samples. This is performed within our malware analysis lab created in a Windows 10 virtual machine running VMware.
<br />


<h2>Languages and Utilities Used</h2>

- <b>VMware</b> 
- <b>Hashcalc</b> 
- <b>VirusTotal</b>
- <b>VMware</b> 
- <b>Exeinfo PE</b>
- <b>HxD</b>
- <b>Cmder</b>
  - <b>XORSearch</b>
  - <b>FLOSS</b>



<h2>Environments Used </h2>

- <b>Windows 10</b>

<h2>Program walk-through:</h2>

<p align="center">
First we will load our malware sample into the HxD utility. HxD will display the file's content in hexadecimal format on the left side and the corresponding ASCII characters on the right side. The hexadecimal view shows the raw data, while the ASCII view can give hints about readable strings and potential indicators of malicious behavior. We can use the search feature (or Ctrl+F) to search for specific strings within the file, for example, the first two bytes 4D 5A indicate an MZ header, common in Windows executables.<br/>
<br/>
<img src="https://i.imgur.com/pTdzjAM.png" height="80%" width="80%" alt="Searching for specific strings"/>
<br/>
<br/>
Here we see exactly the 4D and 5A bytes, which warrants taking a closer look at the sameple. Next we will search for the message "This program cannot be run in DOS mode" within the ASCII characters on the right. When analyzing a file in a hex editor like HxD, encountering this message in the initial bytes of the file is a strong indicator that the file is a Windows PE executable and helps confirm the file format before delving into more detailed analysis.<br/>
<br/>
<br/>
<img src="https://i.imgur.com/CvkKarY.png" height="80%" width="80%" alt="Searching for malware inidcators"/>
<br/>
<br/>
Using this program is particularly useful because even if the file has been given the wrong extension, for example a .jpg extension, the hex editor will still be able to identify the true contents of the file and display it to us.<br/>
<br/>
<br/>
Another useful tool for this is the Cmder utility. If we open this, type *file* and then drag in the file (or type the file path), this utility will tell us the format of the file, regardless of the extension that it has been given.<br/>
<br/>
<img src="https://i.imgur.com/FhSrLv4.png" height="80%" width="80%" alt="Using Cmder to analyze file type"/>
<br/>
<br/>
Now that we've confirmed the file type, we can go ahead and fingerprint the file using a hashing utility, in this case HashCalc.<br/>
<br/>
<br/>
<img src="https://i.imgur.com/viGI0Eq.png" height="80%" width="80%" alt="Take hash fingerprint of file"/>
<br />
<br />
Then we can use a database of known malicious files to cross reference it. For this we will use virustotal.com.<br/>
<br/>
<br/>
<img src="https://i.imgur.com/McPgR4E.png" height="80%" width="80%" alt="Upload to virustotal"/>
<br/>
<br/>
VirusTotal will tell us whether the file had been previously identified as malicious by multiple antivirus engines, providing insights into its threat level and history.<br/>
<br/>
<img src="https://i.imgur.com/b6dL3xJ.png" height="80%" width="80%" alt="Virustotal results"/>
<br/>
<br/>
Now we can move on to searching for strings within the malware that can give us further insight into the nature of the malware. To do this we go back to the Cmder utility and input the command "strings -n 5 C: \Users \SOC \Desktop \Malware \XMoon. exe". This searches for all strings above five characters and can help narrow down the search. We can input any number within this command to narrow down our search.<br/>
<br/>
<br/>
<img src="https://i.imgur.com/A51YGjE.png" height="80%" width="80%" alt="Search for strings with Cmder"/>
<br/>
<br/>
Already we see some suspicious contents.
<br/>
<br/>
<img src="https://i.imgur.com/oa6WINJ.png" height="80%" width="80%" alt="Suspicious contents"/>
<br/>
<br/>
<img src="https://i.imgur.com/Z10XAms.png" height="80%" width="80%" alt="More suspicious contents"/>
<br/>
<br/>
We can also output these strings to a .txt file for forensic purposes and to facilitate searching through the contents.<br/>
<br/>
<br/>
<img src="https://i.imgur.com/AFXvYlh.png" height="80%" width="80%" alt="Output strings to txt file"/>
<br/>
<br/>
<img src="https://i.imgur.com/rP3rMAc.png" height="80%" width="80%" alt="Strings within txt file"/>
<br/>
<br/>
Another useful tool for extracting and searching through strings in the Bintext utility. The benefit of Bintext is that it has a graphical interface and can be more accessible to users who prefer GUI over CLI.<br/>
<br/>
<br/>
<img src="https://i.imgur.com/blRrhKk.png" height="80%" width="80%" alt="Strings in Bintext"/>
<br/>
<br/>
Another powerful tool we can use within Cmder is XORSearch. XORSearch is a utility specifically designed for searching XOR-encoded data within binary files. XOR (exclusive OR) encoding is a common technique used by malware authors to obfuscate strings and data within their programs. XORSearch helps analysts find such obfuscated data by performing searches with various XOR keys. Using XORSearch we can search for specific patterns or strings within the encoded data such as URLs.
<br/>
<br/>
<img src="https://i.imgur.com/LDlFmA9.png" height="80%" width="80%" alt="Using XORSearch"/>
<br/>
<br/>
Observe the wiped disk:  <br/>
<img src="https://i.imgur.com/AeZkvFQ.png" height="80%" width="80%" alt="Disk Sanitization Steps"/>
</p>

<!--
 ```diff
- text in red
+ text in green
! text in orange
# text in gray
@@ text in purple (and bold)@@
```
--!>
